<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="../css/funcoes3.css">


    <title>Document</title>
</head>

<body>

    <div class="tela">



        <img class="raio_solar" id="raio_solar" style="display: none" src="../img/funcoes/fase3/raio_solar.gif">




        <div class="barraVida" id="barraVida">HP</div>
        <div>

            <div class="barraVidaReal"></div>
        </div>

        <div>
            <div class="barraEspecial" id="barraEspecial"></div>
            <h3 class="barraEspecial_h3" id="barraEspecial_h3" style="display: none">A</h3>
            <div>

                <div>
                    <div class="barraEspecialReal" id="barraEspecialReal"></div>
                </div>

                <div class="vidaJogador">
                    <h3 class="vidas">Vidas:</h3>
                    <h3 class="qtdVidas" id="qtdVidas">5</h3>
                </div>

                <div class="chao1">
                    <img class="bloco1" src="../img/recursividade/chao.png">
                </div>


                <div class="carvao">
                    <img class="carvao" id="carvao" src="../img/funcoes/fase3/carvao.png">
                </div>
                <div class="panela">
                    <img class="panela" id="panela" src="../img/funcoes/fase3/cozinhando.png">
                </div>
                <div class="fogo">
                    <img class="fogo" id="fogo" src="../img/funcoes/fase3/fogo.png">
                </div>


                <div class="forno">
                    <img class="forno" id="forno" src="../img/funcoes/forno.png">
                </div>

                <div class="jumpluff">
                    <img class="jumpluff" id="jumpluff" src="../img/funcoes/fase3/jumpluff.png">
                </div>


                <div class="ataque">
                    <img class="ataque" id="ataque" style="display: none" src="../img/funcoes/fase3/algodao.png">
                </div>

                <div class="nuvem">
                    <img class="nuvem" id="nuvem" src="../img/funcoes/fase2/nuvens.png">
                </div>



                <div class="nuvem2">
                    <img class="nuvem2" id="nuvem2" src="../img/funcoes/fase2/nuvens.png">
                </div>




                <script>

                    var vetorAliens = [];
                    var controle = 1;
                    var aliensMortos = [];
                    var saude = 0;



                    const loop = setInterval(() => {

                        var forno = document.getElementById("forno");
                        var ataque = document.querySelector("#ataque");
                        var jumpluff = document.querySelector("#jumpluff");


                        var comidas = document.querySelectorAll("div.carvao #carvao, div.panela #panela, div.fogo #fogo");


                        for (var i = 0; i < comidas.length; i++) {
                            if ((jumpluff.x + 30 < comidas[i].x + comidas[i].width && jumpluff.x - 30 + jumpluff.width > comidas[i].x) && (jumpluff.y + 30 < comidas[i].y + comidas[i].height && jumpluff.y - 30 + jumpluff.height > comidas[i].y)) {
                                document.getElementById("qtdVidas").innerHTML = document.getElementById("qtdVidas").childNodes[0].nodeValue - 1;
                                
                            }

                        }


                        if( document.getElementById("qtdVidas").childNodes[0].nodeValue == 0){
                            window.alert("voce perdeu ");
                        }














                        //console.log (ataque.y , forno.y + forno.height , "  &&  ",ataque.y + forno.height, forno.y);
                        if (document.getElementById("ataque").style.display == 'block' && (ataque.y < forno.y + forno.height && ataque.y + ataque.height > forno.y)) {


                            var vida = document.getElementById("barraVida");
                            vida = vida.offsetWidth;
                            var vida = document.getElementById("barraVida").style.width = vida - 20 + "px";


                            var especial = document.getElementById("barraEspecial");
                            especial = especial.offsetWidth;
                            var especial = document.getElementById("barraEspecial").style.width = especial - 15 + "px";



                            if (especial == "-12px") {
                                document.getElementById("barraEspecial_h3").style.display = "block";

                            }


                        }





                    }, 300);




                    const moverCima = () => {


                        const el = document.querySelector('#jumpluff');
                        const value = getComputedStyle(el).getPropertyValue('bottom');


                        var remove_string = value.replace('px', '');
                        var valorNum = parseInt(remove_string);

                        var numPx = valorNum + 10;
                        var soma = parseInt(value) + 10;

                        jumpluff.style.bottom = soma + "px";

                    }

                    const moverBaixo = () => {

                        const el = document.querySelector('#jumpluff');

                        const value = getComputedStyle(el).getPropertyValue('bottom');


                        var remove_string = value.replace('px', '');
                        var valorNum = parseInt(remove_string);

                        var numPx = valorNum + 10;
                        var soma = parseInt(value) - 10;

                        jumpluff.style.bottom = soma + "px";

                    }



                    const mover = () => {

                        var tecla = event.keyCode;

                        var vida = document.getElementById("barraVida");
                        vida = vida.offsetWidth;

                        var per = document.getElementById("jumpluff");
                        var ataque = document.querySelector("#ataque");
                        var raio_solar = document.querySelector("#raio_solar");

                        var especial = document.getElementById("barraEspecial");
                        especial = especial.offsetWidth;



                        per.getBoundingClientRect();
                        ataque.getBoundingClientRect();
                        
                            

                        if (tecla == 65 && (especial <= 8)) {


                            var posicaoJumpluff = per.style.bottom;

                            var remove_string = posicaoJumpluff.replace('px', '');
                            var valorNum = parseInt(remove_string);

                            raio_solar.style.bottom = (valorNum + 50) + "px";

                            document.getElementById("raio_solar").style.display = 'block';
                            raio_solar.style.animationPlayState = "running";



                            setTimeout(function () {
                                document.getElementById("raio_solar").style.display = 'none';
                                raio_solar.style.animationPlayState = "restart";
                                raio_solar.style.animationPlayState = "paused";

                                document.getElementById("barraVida").style.width = vida - 150 + "px";

                                document.getElementById("barraEspecial").style.width = "15%";
                                document.getElementById("barraEspecial_h3").style.display = "none";

                            }, 1000);


                        }

                        if (tecla == 32) {

                            var posicaoJumpluff = per.style.bottom;

                            ataque.style.bottom = posicaoJumpluff;

                            document.getElementById("ataque").style.display = 'block';

                            window.requestAnimationFrame(function () {
                                ataque.style.animation = 'jumpluff_ataque 1s infinite linear';
                            });

                            setTimeout(function () {
                                document.getElementById("ataque").style.display = 'none';

                            }, 400);

                        }


                        if (tecla == 38) {
                            moverCima();
                        } else if (tecla == 40) {
                            moverBaixo();
                        }


                    }


                    document.addEventListener('keydown', mover);

                </script>
</body>

</html>