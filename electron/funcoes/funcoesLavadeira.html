<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="../css/funcoes4.css">


    <title>Document</title>
</head>

<body>

    <div class="tela">
      
    

        <div class="cortador">
            <img class="cortador" id="cortador" src="../img/funcoes/lavadeira.png">
        </div>

        <div class="hoppip">
            <img class="hoppip" id="hoppip" src="../img/funcoes/fase1/hoppip.gif">
        </div>

        <div class="ataque">
            <img class="ataque" id="ataque" style="display: none" src="../img/funcoes/fase1/ataque.png">
        </div>






        <script>
            var vetorAliens = [];
            var controle = 1;
            var aliensMortos = [];

            var inicio = 10;
            var final = 90;
            for (var k = 0; k < 4; k++) {

                for (var i = inicio; i <= final; i++) {

                    if (k == 0) {
                        var img = document.createElement('img');
                        img.src = '../img/funcoes/fase4/muk.png';
                        img.classList.add('alien');
                        img.id = 'alien' + i;
                        img.style.top = "0%";
                        img.style.width = "6%";
                        img.style.left = i + "%";

                        var body = document.querySelector("body");
                        i = i + 6;

                        vetorAliens.push(img);
                        body.appendChild(img);
                    } else if (k == 1) {
                        var img = document.createElement('img');
                        img.src = '../img/funcoes/fase4/muk.png';
                        img.classList.add('alien');
                        img.id = 'alien' + i;
                        img.style.top = "7%";
                        img.style.width = "6%";
                        img.style.left = i + "%";

                        var body = document.querySelector("body");
                        i = i + 6;

                        vetorAliens.push(img);
                        body.appendChild(img);
                    } if (k == 2) {
                        var img = document.createElement('img');
                        img.src = '../img/funcoes/fase4/muk.png';
                        img.classList.add('alien');
                        img.id = 'alien' + i;
                        img.style.top = "14%";
                        img.style.width = "6%";
                        img.style.left = i + "%";

                        var body = document.querySelector("body");
                        i = i + 6;

                        vetorAliens.push(img);
                        body.appendChild(img);
                    } else if (k == 3) {
                        var img = document.createElement('img');
                        img.src = '../img/funcoes/fase4/muk.png';
                        img.classList.add('alien');
                        img.id = 'alien' + i;
                        img.style.top = "22%";
                        img.style.width = "6%";
                        img.style.left = i + "%";

                        var body = document.querySelector("body");
                        i = i + 6;

                        vetorAliens.push(img);
                        body.appendChild(img);
                    }


                }

                inicio = inicio + 10;
                final = final - 10;
            }



            var j = 0;
            for (var i = 1; j <= 91; i++) {


                var img = document.createElement('img');
                img.src = '../img/funcoes/fase4/sujeira.png';
                img.classList.add('sujeira');
                img.id = 'sujeira' + i;
                img.style.bottom = "-1%";
                img.style.width = "3%";
                img.style.left = j + "%";

                var body = document.querySelector("body");
                j = j + 3.8;

                body.appendChild(img);

            }

            const loop = setInterval(() => {

                var ataque = document.getElementById("ataque");
                ataque.getBoundingClientRect();





                for (var i = 0; i < vetorAliens.length; i++) {

                    if ((ataque.x + 80 < vetorAliens[i].x + vetorAliens[i].width && ataque.x - 80 + ataque.width < vetorAliens[i].x) && (ataque.y + 30 < vetorAliens[i].y + vetorAliens[i].height && ataque.y - 30 + ataque.height < vetorAliens[i].y)) {

                    //if ((ataque.x > vetorAliens[i].x + vetorAliens[i].width - 80 && ataque.x + ataque.width < vetorAliens[i].x + 80) && (ataque.y < vetorAliens[i].y + vetorAliens[i].height && ataque.y + ataque.height > vetorAliens[i].y)) {

                        if (vetorAliens[i].src.includes('servico-eletrico.png')) {

                            const cortador = document.querySelector('#cortador');
                            cortador.getBoundingClientRect();

                           

                            var sujeiras = document.querySelectorAll('.sujeira');
                            var ultimo = sujeiras[sujeiras.length -1];


                            cortador.style.animationPlayState = "running"; //running

                            setTimeout(function () {
                                cortador.style.animationPlayState = "paused"; //running
                            }, 1000);

                            ultimo.remove();
                            

                            vetorAliens[i].src = '../img/funcoes/fase4/muk.png';
                            vetorAliens[i].style.width = "6%";

                        }

                        document.getElementById("ataque").style.display = 'none';
                        vetorAliens[i].style.display = "none";

                        aliensMortos.push(vetorAliens[i]);
                        controle = controle + 1;
                        break;

                    }

                }

                if (controle == 5 || controle == 10 || controle == 15 || controle == 22 || controle == 28) {

                    for (var i = 0; i < aliensMortos.length; i++) {



                        aliensMortos[i].style.display = "block";
                        aliensMortos.splice(i, 1);

                        if (i == aliensMortos.length - 1) {
                            aliensMortos[i].src = '../img/funcoes/fase1/servico-eletrico.png';
                            aliensMortos[i].style.width = "4%";
                        }

                    }
                }


            }, 5);


            const moverDireita = () => {



                document.getElementById("hoppip").src = "../img/funcoes/fase1/hoppip.gif";

                const el = document.querySelector('.hoppip');
                const value = getComputedStyle(el).getPropertyValue('left');


                var remove_string = value.replace('px', '');
                var valorNum = parseInt(remove_string);

                var numPx = valorNum + 10;
                var soma = parseInt(value) + 10;

                el.style.left = soma + "px";



            }



            const moverEsquerda = () => {

                document.getElementById("hoppip").src = "../img/funcoes/fase1/hoppip_costa.gif";

                const el = document.querySelector('.hoppip');
                const value = getComputedStyle(el).getPropertyValue('left');


                var remove_string = value.replace('px', '');
                var valorNum = parseInt(remove_string);

                var numPx = valorNum + 10;
                var soma = parseInt(value) - 10;

                el.style.left = soma + "px";

            }








            const mover = () => {

                var tecla = event.keyCode;

                var per = document.getElementById("hoppip");
                var ataque = document.getElementById("ataque");


                per.getBoundingClientRect();
                ataque.getBoundingClientRect();


                if (tecla == 32) {


                    var posicaoHoppip = per.x;

                    ataque.style.left = (posicaoHoppip + 50) + "px";


                    document.getElementById("ataque").style.display = 'block';

                    ataque.style.animation = 'none';

                    window.requestAnimationFrame(function () {
                        ataque.style.animation = 'hoppip_ataque 0.5s linear';
                    });


                    setTimeout(function () {
                        document.getElementById("ataque").style.display = 'none';

                    }, 400);






                }

                if (tecla == 39) {
                    moverDireita();

                } else if (tecla == 37) {
                    moverEsquerda();
                }


            }


            document.addEventListener('keydown', mover);

        </script>
</body>

</html>