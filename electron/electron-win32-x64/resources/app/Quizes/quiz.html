<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="../telaInicial/dialogos.js"></script>
    <script src="../sweetalert/sweetalert.js"></script>
    <script src="../telaInicial/dialogos.js"></script>
    <script src="./questions.js"></script>
    <link rel="stylesheet" href="quiz1.css">
</head>

<body>
    <audio id="audio" src="../sounds/quizFinal.mp3" loop autoplay></audio>

    <div>
        <img id="uA" src="../img/unowns/a.gif"></img>
        <img id="uB" src="../img/unowns/b.gif"></img>
        <img id="uC" src="../img/unowns/c.gif"></img>
        <img id="starmie" src="../img/repeticao/starmie.png"></img>
        <img id="seaking" src="../img/repeticao/seaking.png"></img>
        <img id="rotom" src="../img/funcoes/rotom.png"></img>
        <img id="abra" src="../img/excecoes/fantasmas/abra_shiny.png"></img>
        <img id="magnemite" src="../img/extras/magnemite2.png"></img>
    </div>

    <h2>Desafio da Vitória</h2>
    <main>
        <div class="content">
            <span class="spnQtd"></span>
            <span class="question"></span>
            <div class="answers"></div>
        </div>
        <div class="finish">
            <span></span>
            <button id="finalizar">Finalizar</button>
        </div>
    </main>

</body>

</html>

<script>
    const question = document.querySelector(".question");
    const answers = document.querySelector(".answers");
    const spnQtd = document.querySelector(".spnQtd");
    const textFinish = document.querySelector(".finish span");
    const content = document.querySelector(".content");
    const contentFinish = document.querySelector(".finish");
    const btnRestart = document.querySelector(".finish button");

    var url = new URLSearchParams(window.location.search);
    var faseAtual = url.get('fase');
    var faseAtual = parseInt(faseAtual);
      


    let currentIndex = 0;
    let questionsCorrect = 0;

   /* btnRestart.onclick = () => {
        content.style.display = "flex";
        contentFinish.style.display = "none";

        currentIndex = 0;
        questionsCorrect = 0;
        loadQuestion();
    };*/

    function nextQuestion(e) {

        if (e.target.getAttribute("data-correct") === "true") {
            questionsCorrect++;
        }

        if (currentIndex < perguntas.length - 1) {            
            currentIndex++;
            loadQuestion();
        } else {
            finish();
        }
        
    }

    function finish() {
        textFinish.innerHTML = `você acertou ${questionsCorrect} de ${perguntas.length}`;
        content.style.display = "none";
        contentFinish.style.display = "flex";

        document.querySelector("#finalizar").addEventListener('click', function () {
            window.location.href = "http://localhost/jogo/electron/telaInicial/city.html?id=1";
        });
    }

    function loadQuestion() {
        
        spnQtd.innerHTML = `${currentIndex + 1}/${perguntas.length}`;
        const item = perguntas[currentIndex];
        answers.innerHTML = "";
        question.innerHTML = item.question;

        item.answers.forEach((answer) => {
            const div = document.createElement("div");

            div.innerHTML = `
    <button class="answer" data-correct="${answer.correct}">
      ${answer.option}
    </button>
    `;

            answers.appendChild(div);
        });

        document.querySelectorAll(".answer").forEach((item) => {
            item.addEventListener("click", nextQuestion);
        });
    }

    loadQuestion();

    const voltar_menu = () => {
            var tecla = event.keyCode;
            if (tecla == 27) {
                window.location.href = "http://localhost/jogo/electron/telaInicial/city.html";
            }
        }
    document.addEventListener('keydown', voltar_menu);


</script>