<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" id="diretorio" href="../css/recursividade.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

    <div class="campo">

        <div class="cherrim" style="display: block">
            <img class="cherrim" id="cherrim" src="../img/recursividade/cherrim-sunshine.gif">
        </div>

        <div class="dewgong">
            <img class="dewgong" id="dewgong" style="display: none" src="../img/recursividade/dewgong.gif">
        </div>

        <div class="pidgeot">
            <img class="pidgeot" id="pidgeot" style="display: none" src="../img/recursividade/pidgeot.gif">
        </div>

        <div class="Weezing">
            <img class="Weezing" id="Weezing" style="display: none" src="../img/recursividade/Weezing.gif">
        </div>

        <div class="arbok">
            <img class="arbok" id="arbok" style="display: none" src="../img/recursividade/arbok.gif">
        </div>
        
        <div>
           <img class="klefki" id="klefki" src="../img/recursividade/klefki.gif">
        </div>

        <div class="equipeRocket">
            <img class="equipeRocket" id="equipeRocket" style="display: none"
                src="../img/recursividade/equipe rocket.png">
        </div>

        <div>
            <img class="chuva" id="chuva" style="display: none" src="../img/repeticao/chuva.gif">
        </div>

        <div class="rio" id="rio" style="display: none"></div>

        <div class="teleport">
            <img id="teleport1" style="display: none" src="../img/recursividade/teleport.gif">
            <img id="teleport2" style="display: none" src="../img/recursividade/teleport.gif">
            <img id="teleport3" style="display: none" src="../img/recursividade/teleport.gif">
        </div>

        <div class="porta0">
            <img class="porta0" src="../img/recursividade/porta_aberta2.png">
        </div>

        <div class="porta1">
            <h2 id="resposta1">7</h2>
            <img class="porta1" id="porta1" src="../img/recursividade/porta.png">
        </div>

        <div class="porta2">
            <h2 id="resposta2">2</h2>
            <img class="porta2" id="porta2" src="../img/recursividade/porta.png">
        </div>

        <div class="porta3">
            <h2 id="resposta3">28</h2>
            <img class="porta3" id="porta3" src="../img/recursividade/porta.png">
        </div>

        <div class="porta4">
            <h2 id="resposta4">100</h2>
            <img class="porta4" id="porta4" src="../img/recursividade/porta.png">
        </div>

        <div class="portaAberta1">
            <img class="portaAberta1" id="portaAberta1" src="../img/recursividade/orbeetle-gigantamax_esquerda.gif">
        </div>

        <div class="portaAberta2">
            <img class="portaAberta2" id="portaAberta2" src="../img/recursividade/orbeetle-gigantamax_direita.gif">
        </div>


        <div class="chao1">
            <img class="bloco1" src="../img/recursividade/chao.png">
        </div>
        <div class="chao2">
            <img class="bloco2" src="../img/recursividade/chao.png">
        </div>
        <div class="chao3">
            <img class="bloco3" src="../img/recursividade/chao.png">
        </div>
        <div class="chao4">
            <img class="bloco4" src="../img/recursividade/chao.png">
        </div>


        <div class="escadas">
            <div class="escada1" id="1">
                <img class="escada1" id="escada1" ondragover="areaColisao(event)" src="../img/recursividade/escada.png">
            </div>
            <div class="escada2" id="2">
                <img class="escada2" id="escada2" ondragover="areaColisao(event)" src="../img/recursividade/escada.png">
            </div>

            <div class="escada3" id="3">
                <img class="escada3" id="escada3" ondragover="areaColisao(event)" src="../img/recursividade/escada.png">
            </div>
            <div class="escada4" id="4">
                <img class="escada4" id="escada4" ondragover="areaColisao(event)" src="../img/recursividade/escada.png">
            </div>

            <div class="escada5" id="5">
                <img class="escada5" id="escada5" ondragover="areaColisao(event)" src="../img/recursividade/escada.png">
            </div>
        </div>


        <div class="pedra">
            <img class="pedra1" id="pedra1" src="../img/recursividade/tronco.png">
        </div>

        <div class="pedra">
            <img class="pedra2" id="pedra2" src="../img/recursividade/tronco.png">
        </div>

        <div class="pedra">
            <img class="pedra3" id="pedra3" src="../img/recursividade/tronco.png">
        </div>

        <div class="pedra">
            <img class="pedra4" id="pedra4" src="../img/recursividade/tronco.png">
        </div>


        <div class="personagem">
            <img class="personagem" id="personagem" ondragstart="personagemIniciado(event)"
                src="../img/recursividade/1_direita.png">
        </div>


        <div class="pergunta">
            <h5 id="pergunta">Pegue as chaves para abrir as portas</h5>
        </div>

        <div class="andar">
            <img class="sinalizador" id="sinalizador" src="../img/recursividade/klefki.gif">
            <h1 id="andar">0/1</h1>

        </div>

        <div class="espaco">
            <img class="espaco" id="espaco" src="../img/recursividade/space.png" style="display:none">
        </div>

    </div>








    <script>

        var cenario = 1;
        var pergunta = 0;
        var controle = 0;
        var estado_Porta = 0;


        var contador = 0;

        const personagemIniciado = (event) => {
            event.dataTransfer.setData("img", event.target.id);
        }

        const areaColisao = (event) => {
            event.preventDefault();
        }





        const loop = setInterval(() => {

            var bulbasaur = document.getElementById("personagem");
            bulbasaur.getBoundingClientRect();



            var pedras = document.querySelectorAll("div.pedra #pedra1, div.pedra #pedra2, div.pedra #pedra3, div.pedra #pedra4");



            for (var i = 0; i < pedras.length; i++) {
                if ((bulbasaur.x < pedras[i].x + pedras[i].width && bulbasaur.x + bulbasaur.width > pedras[i].x) && (bulbasaur.y < pedras[i].y + pedras[i].height && bulbasaur.y + bulbasaur.height > pedras[i].y)) {
                    personagem.style.bottom = "1%";
                    personagem.style.left = "0%";
                    valor = "livre";
                    if(contador > 0){
                        document.getElementById("andar").innerHTML = (contador - 1) + "/1";
                    }                    
                    contador = contador - 1;

                    verificaQtd();
                }
            }


            if (cenario == 1 || cenario == 5) {
                var pokemon = "cherrim";
            } else if (cenario == 2 || cenario == 6) {
                var pokemon = "dewgong";
            } else if (cenario == 3 || cenario == 7) {
                var pokemon = "pidgeot";
            } else if (cenario == 4) {
                var pokemon = "arbok";
            } else {
                var pokemon = "Weezing";

            }

            var poke = document.querySelector("#" + pokemon);
            poke.getBoundingClientRect();

            if ((bulbasaur.x < poke.x + poke.width && bulbasaur.x + bulbasaur.width > poke.x && bulbasaur.y < poke.y + poke.height && bulbasaur.y + bulbasaur.height > poke.y)) {
                personagem.style.bottom = "1%";
                personagem.style.left = "0%";
                valor = "livre";
                if(contador > 0){
                    document.getElementById("andar").innerHTML = (contador - 1) + "/1";
                }
                contador = contador - 1;
                verificaQtd();
            }

            if ((bulbasaur.x < klefki.x + klefki.width && bulbasaur.x + bulbasaur.width > klefki.x && bulbasaur.y < klefki.y + klefki.height && bulbasaur.y + bulbasaur.height > klefki.y)) {

                var esquerda = ["12", "22", "32", "42", "52", "62"];
                var esquerdaEmbaralhar = Math.floor(Math.random() * esquerda.length);

                var baixo = ["45", "65", "85"];
                var baixoEmbaralhar = Math.floor(Math.random() * baixo.length);

                klefki.style.left = esquerdaEmbaralhar*18 + "%";
                klefki.style.bottom = baixoEmbaralhar*32 + "%";

                if (cenario == 1){
                    if(contador == 0){
                        contador = contador + 1;
                        document.getElementById("andar").innerHTML = contador + "/1";
                        verificaQtd();
                    }
                    
                }else if(cenario == 2){

                    if(contador == 0){
                        contador = contador + 1;
                        document.getElementById("andar").innerHTML = contador + "/1"; 
                        verificaQtd();
                    }              
                    
                }else if(cenario == 3){
                    if(contador < 3){
                        contador = contador + 1;
                        document.getElementById("andar").innerHTML = contador + "/2";
                        verificaQtd();
                    }
                    
                   
                }else if(cenario == 4){
                    if(contador < 4){
                        contador = contador + 1;
                        document.getElementById("andar").innerHTML = contador + "/3";
                        verificaQtd();
                    }
                    
                }else if(cenario == 5){
                    if(contador < 6){
                        contador = contador + 1;
                        document.getElementById("andar").innerHTML = contador + "/5";
                        verificaQtd();
                    }
                    
                }else if(cenario == 6){
                    if(contador < 9){
                        contador = contador + 1;
                        document.getElementById("andar").innerHTML = contador + "/8";
                        verificaQtd();
                    }
                    
                }else{
                    if(contador < 14){
                        contador = contador + 1;
                        document.getElementById("andar").innerHTML = contador + "/13";              
                        verificaQtd();
                    }
                    
                }


            }


          


        }, 5);



        const loop2 = setInterval(() => {

            var esquerda = ["12", "22", "32", "42", "52", "62"];
            var esquerdaEmbaralhar = Math.floor(Math.random() * esquerda.length);

            var baixo = ["45", "65", "85"];
            var baixoEmbaralhar = Math.floor(Math.random() * baixo.length);

            klefki.style.left = esquerdaEmbaralhar*18 + "%";
            klefki.style.bottom = baixoEmbaralhar*32 + "%";

            var id = document.getElementById("porta1"); 
                


        }, 10000);
    </script>





    <script>
        listaEscada = [];
        valor = "livre";


        const verificaQtd = () =>{
            if(contador == 1 && cenario == 1){
                document.getElementById("porta1").src =  "../img/recursividade/porta_aberta2.png";
                document.getElementById("porta1").style.width = "18%";
                estado_Porta = 1;
            }else if(contador == 1 && cenario == 2){
                document.getElementById("porta1").src =  "../img/recursividade/porta_aberta2.png";
                document.getElementById("porta1").style.width = "18%";
                estado_Porta = 1;
            }else if(contador == 2 && cenario == 3){
                document.getElementById("porta1").src =  "../img/recursividade/porta_aberta2.png";
                document.getElementById("porta1").style.width = "18%";
                estado_Porta = 1;
            }else if(contador == 3 && cenario == 4){
                document.getElementById("porta1").src =  "../img/recursividade/porta_aberta2.png";
                document.getElementById("porta1").style.width = "18%";
                estado_Porta = 1;
            }else if(contador == 5 && cenario == 5){
                document.getElementById("porta1").src =  "../img/recursividade/porta_aberta2.png";
                document.getElementById("porta1").style.width = "18%";
                estado_Porta = 1;
            }else if(contador == 8 && cenario == 6){
                document.getElementById("porta1").src =  "../img/recursividade/porta_aberta2.png";
                document.getElementById("porta1").style.width = "18%";
                estado_Porta = 1;
            } else if(contador == 13 && cenario == 7){
                document.getElementById("porta1").src =  "../img/recursividade/porta_aberta2.png";
                document.getElementById("porta1").style.width = "18%";
                estado_Porta = 1;
            }else{
                document.getElementById("porta1").src =  "../img/recursividade/porta.png";
                document.getElementById("porta1").style.width = "30%";
                estado_Porta = 0;

            }

        }

    


        const mudarCenario = () => {

            document.getElementById("porta1").src =  "../img/recursividade/porta.png";
            document.getElementById("porta1").style.width = "30%";
            contador = 0;           


            switch (cenario) {
                case 1: case 5:
                    if (cenario == 5) {
                        document.getElementById("andar").innerHTML = contador + "/5";
                    }
                    document.getElementById("diretorio").href = "../css/recursividade.css";
                    document.getElementById("rio").style.display = "none";
                    document.getElementById("dewgong").style.display = "none";
                    document.getElementById("chuva").style.display = "none";
                    document.getElementById("cherrim").style.display = "block";
                    document.getElementById("arbok").style.display = "none";
                    document.getElementById("Weezing").style.display = "none";
                    document.getElementById("equipeRocket").style.display = "none";
                    document.getElementById("pidgeot").style.display = "none";
                    personagem.style.bottom = "1%";
                    personagem.style.left = "0%";
                    break;
                case 2: case 6:
                    if (cenario == 2) {
                        document.getElementById("andar").innerHTML = contador + "/1";
                    }else{
                        document.getElementById("andar").innerHTML = contador + "/8";
                    }
                    document.getElementById("diretorio").href = "../css/recursividade1.css";
                    document.getElementById("rio").style.display = "block";
                    document.getElementById("dewgong").style.display = "block";
                    document.getElementById("chuva").style.display = "block";
                    document.getElementById("cherrim").style.display = "none";
                    document.getElementById("arbok").style.display = "none";
                    document.getElementById("Weezing").style.display = "none";
                    document.getElementById("equipeRocket").style.display = "none";
                    document.getElementById("pidgeot").style.display = "none";
                    personagem.style.bottom = "1%";
                    personagem.style.left = "0%";
                    break;
                case 3: case 7:
                    if (cenario == 3) {
                        document.getElementById("andar").innerHTML = contador + "/2";
                    }else{
                        document.getElementById("andar").innerHTML = contador + "/13";
                    }
                    document.getElementById("diretorio").href = "../css/recursividade2.css";
                    document.getElementById("rio").style.display = "none";
                    document.getElementById("dewgong").style.display = "none";
                    document.getElementById("chuva").style.display = "none";
                    document.getElementById("cherrim").style.display = "none";
                    document.getElementById("arbok").style.display = "none";
                    document.getElementById("Weezing").style.display = "none";
                    document.getElementById("equipeRocket").style.display = "none";
                    document.getElementById("pidgeot").style.display = "block";
                    document.getElementById("escada1").style.display = "none";
                    document.getElementById("escada3").style.display = "none";

                    personagem.style.bottom = "1%";
                    personagem.style.left = "0%";
                    break;
                case 4: case 8:
                    if (cenario == 4) {
                        document.getElementById("andar").innerHTML = contador + "/3";
                    }
                    document.getElementById("diretorio").href = "../css/recursividade3.css";
                    document.getElementById("rio").style.display = "none";
                    document.getElementById("dewgong").style.display = "none";
                    document.getElementById("chuva").style.display = "none";
                    document.getElementById("cherrim").style.display = "none";
                    document.getElementById("arbok").style.display = "block";
                    if (cenario == 8) {
                        document.getElementById("Weezing").style.display = "block";
                        document.getElementById("arbok").style.display = "none";
                        document.getElementById("escada1").style.display = "block";
                    }
                    document.getElementById("equipeRocket").style.display = "block";
                    document.getElementById("pidgeot").style.display = "none";
                    personagem.style.bottom = "1%";
                    personagem.style.left = "0%";
                    break;

            }

        }

        const moverDireita = () => {



            document.getElementById("personagem").src = "../img/recursividade/1_direita.png";

            const el = document.querySelector('.personagem');
            const value = getComputedStyle(el).getPropertyValue('left');


            var remove_string = value.replace('px', '');
            var valorNum = parseInt(remove_string);

            var numPx = valorNum + 10;
            var soma = parseInt(value) + 10;

            personagem.style.left = soma + "px";



        }



        const moverEsquerda = () => {

            document.getElementById("personagem").src = "../img/recursividade/1_esquerda.png";

            const el = document.querySelector('.personagem');
            const value = getComputedStyle(el).getPropertyValue('left');


            var remove_string = value.replace('px', '');
            var valorNum = parseInt(remove_string);

            var numPx = valorNum + 10;
            var soma = parseInt(value) - 10;

            personagem.style.left = soma + "px";

        }

        const moverCima = () => {

            document.getElementById("personagem").src = "../img/recursividade/1_cima.png";

            const el = document.querySelector('.personagem');
            const value = getComputedStyle(el).getPropertyValue('bottom');





            var remove_string = value.replace('px', '');
            var valorNum = parseInt(remove_string);

            var numPx = valorNum + 10;
            var soma = parseInt(value) + 10;

            personagem.style.bottom = soma + "px";

        }

        const moverBaixo = () => {

            document.getElementById("personagem").src = "../img/recursividade/1_cima.png";

            const el = document.querySelector('.personagem');

            const value = getComputedStyle(el).getPropertyValue('bottom');


            var remove_string = value.replace('px', '');
            var valorNum = parseInt(remove_string);

            var numPx = valorNum + 10;
            var soma = parseInt(value) - 10;

            personagem.style.bottom = soma + "px";

        }




        const personagem = document.querySelector('.personagem');




        const mover = () => {

            var tecla = event.keyCode;

            var chao = document.querySelector('.bloco4');

            var per = document.getElementById("personagem");



            var portas = document.querySelectorAll("#porta1, #porta2, #porta3, #porta4");
            var escadas = document.querySelectorAll("#escada1, #escada2, #escada3, #escada4, #escada5");
            var respostas = document.querySelectorAll("div.porta1  h2, div.porta2  h2, div.porta3  h2, div.porta4  h2");



              if ((per.x < portas[0].x + portas[0].width && per.x + per.width > portas[0].x) && (per.y < portas[0].y + portas[0].height && per.y - 10 + per.height > portas[0].y)) {

                document.getElementById("espaco").style.display = "block";

                    if (tecla == 32 && estado_Porta == 1) {

                           
                            cenario = cenario + 1;
                            contador = 0;
                            mudarCenario();


                            if (cenario == 9) {
                                window.alert("VocÃª concluiu a fase! Voltando ao Mapa da Cidade");
                                window.location.href = "http://localhost/jogo/electron/telaInicial/city.html";
                            }
                            document.getElementById("espaco").style.display = "none";

                           // break;
                        } ;

                }
            




            for (var i = 0; i < escadas.length; i++) {
                escadas[i].getBoundingClientRect();
                listaEscada.push(escadas[i]);

            }
            var posicaoPer = window.getComputedStyle(per).bottom;


            var portaAberta1 = document.getElementById("portaAberta1");
            var portaAberta2 = document.getElementById("portaAberta2");

            per.getBoundingClientRect();
            portaAberta1.getBoundingClientRect();
            portaAberta2.getBoundingClientRect();




            if ((per.x < portaAberta1.x + portaAberta1.width && per.x + per.width > portaAberta1.x && per.y < portaAberta1.y + portaAberta1.height && per.y + per.height > portaAberta1.y) || (per.x < portaAberta2.x + portaAberta2.width && per.x + per.width > portaAberta2.x && per.y < portaAberta2.y + portaAberta2.height && per.y + per.height > portaAberta2.y)) {

                if (per.x + 100 > portaAberta2.x && per.x < 500) {
                    var teleport = "teleport1";
                } else if (per.x > portaAberta2.x) {
                    var teleport = "teleport3";
                }
                setTimeout(function () {
                    personagem.style.bottom = "1%";
                    personagem.style.left = "0%";
                    document.getElementById("teleport2").style.display = 'block';
                    document.getElementById(teleport).style.display = 'block';
                }, 500);

                setTimeout(function () {
                    document.getElementById("teleport2").style.display = 'none';
                    document.getElementById(teleport).style.display = 'none';
                }, 1000);



            }




            if (tecla == 39 && valor == "livre") {
                moverDireita();

            } else if (tecla == 37 && valor == "livre") {
                moverEsquerda();
            }


            else if (tecla == 38) { //x=lagura y=altura

                for (var i = 0; i < escadas.length; i++) {
                    if ((per.x + 30 < escadas[i].x + escadas[i].width && per.x - 30 + per.width > escadas[i].x) && (per.y < escadas[i].y + 10 + escadas[i].height && per.y - 10 + per.height > escadas[i].y)) {

                        valor = "bloqueado";

                        moverCima();
                    }
                    if (per.y <= escadas[i].y - 40) {
                        valor = "livre";

                    }


                }
            }

        }
        document.addEventListener('keydown', mover);
    </script>
</body>

</html>